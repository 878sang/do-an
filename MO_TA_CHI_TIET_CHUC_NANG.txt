================================================================================
                    MÔ TẢ CHI TIẾT CHỨC NĂNG TRANG WEB
                    FASHION STORE E-COMMERCE SYSTEM
                    (Định dạng: Đầu vào - Xử lý - Đầu ra)
================================================================================

CHỨC NĂNG 1: XEM DANH SÁCH SẢN PHẨM
================================================================================

ĐẦU VÀO:
- Khách hàng truy cập vào địa chỉ website trên thanh URL
- Khách hàng chọn menu "Sản phẩm" hoặc truy cập trực tiếp vào trang sản phẩm
- Yêu cầu: Xem danh sách tất cả sản phẩm có sẵn trên website

XỬ LÝ:
- Hệ thống nhận yêu cầu từ khách hàng
- Controller ProductController.Index() được gọi
- Hệ thống truy vấn cơ sở dữ liệu:
  + Lấy danh sách sản phẩm từ bảng TbProducts
  + Lọc các sản phẩm có IsActive = true (sản phẩm đang hoạt động)
  + Sắp xếp theo ngày tạo mới nhất (CreatedDate DESC)
  + Lấy danh sách danh mục sản phẩm từ bảng TbProductCategories
- Dữ liệu được xử lý và gửi lên View

ĐẦU RA:
- Hiển thị danh sách sản phẩm bao gồm:
  + Tên sản phẩm
  + Hình ảnh sản phẩm
  + Giá bán và giá khuyến mãi (nếu có)
  + Danh mục sản phẩm
  + Link chi tiết sản phẩm
- Hiển thị menu danh mục để lọc sản phẩm
- Giao diện trang danh sách sản phẩm với khả năng xem chi tiết từng sản phẩm


================================================================================
CHỨC NĂNG 2: XEM CHI TIẾT SẢN PHẨM
================================================================================

ĐẦU VÀO:
- Khách hàng truy cập vào địa chỉ website trên thanh URL
- Khách hàng chọn một sản phẩm bất kỳ từ danh sách sản phẩm hoặc trang chủ
- Thông tin yêu cầu: ID sản phẩm hoặc Alias của sản phẩm
- URL ví dụ: /product/ao-thun-nam-1.html

XỬ LÝ:
- Hệ thống nhận yêu cầu từ khách hàng
- Controller ProductController.Details(id) được gọi
- Hệ thống truy vấn cơ sở dữ liệu:
  + Lấy thông tin sản phẩm từ bảng TbProducts theo ProductId
  + Lấy thông tin danh mục sản phẩm (CategoryProduct)
  + Lấy danh sách Size có sẵn từ bảng TbProductVariants (kèm Size)
  + Lấy danh sách Color có sẵn từ bảng TbProductVariants (kèm Color)
  + Lấy danh sách đánh giá sản phẩm từ bảng TbProductReviews (kèm thông tin Customer)
  + Lọc các variant và review có IsActive = true
  + Sắp xếp đánh giá theo ngày tạo mới nhất
- Kiểm tra sản phẩm có tồn tại không
- Dữ liệu được xử lý và gửi lên View

ĐẦU RA:
- Hiển thị thông tin chi tiết sản phẩm bao gồm:
  + Tên sản phẩm
  + Hãng sản xuất / Danh mục sản phẩm
  + Mô tả sản phẩm
  + Nội dung chi tiết sản phẩm
  + Hình ảnh sản phẩm
  + Màu sắc có sẵn (Color)
  + Kích thước có sẵn (Size)
  + Giá bán (Price)
  + Giá khuyến mãi (PriceSale) nếu có
  + Số lượng tồn kho (Quantity)
  + Tình trạng sản phẩm (IsActive - Còn hàng/Hết hàng)
  + Đánh giá trung bình (Star)
  + Danh sách đánh giá và bình luận của khách hàng
- Nút "Thêm vào giỏ hàng"
- Nút "Mua ngay"


================================================================================
CHỨC NĂNG 3: THÊM SẢN PHẨM VÀO GIỎ HÀNG
================================================================================

ĐẦU VÀO:
- Khách hàng đang xem chi tiết sản phẩm
- Khách hàng chọn Size, Color, Số lượng
- Khách hàng nhấn nút "Thêm vào giỏ hàng"
- Thông tin yêu cầu:
  + ProductId (ID sản phẩm)
  + SizeId (ID kích thước)
  + ColorId (ID màu sắc)
  + Quantity (Số lượng)

XỬ LÝ:
- Hệ thống nhận yêu cầu từ khách hàng
- Controller CartController được gọi
- Hệ thống xử lý:
  + Kiểm tra thông tin sản phẩm từ cơ sở dữ liệu
  + Lấy thông tin sản phẩm từ bảng TbProducts
  + Lấy giá bán từ ProductVariant hoặc Product
  + Kiểm tra số lượng tồn kho
  + Tạo đối tượng CartItem với thông tin: ProductId, Title, Image, Price, Quantity, Size, Color
  + Lưu CartItem vào Session (CartSessionKey)
  + Nếu sản phẩm đã có trong giỏ, cập nhật số lượng
- Dữ liệu được lưu vào Session

ĐẦU RA:
- Thông báo thành công "Đã thêm sản phẩm vào giỏ hàng"
- Cập nhật số lượng sản phẩm trong giỏ hàng (hiển thị trên icon giỏ hàng)
- Khách hàng có thể tiếp tục mua sắm hoặc xem giỏ hàng


================================================================================
CHỨC NĂNG 4: XEM GIỎ HÀNG
================================================================================

ĐẦU VÀO:
- Khách hàng truy cập vào địa chỉ website trên thanh URL
- Khách hàng chọn menu "Giỏ hàng" hoặc click vào icon giỏ hàng
- Yêu cầu: Xem danh sách sản phẩm đã thêm vào giỏ hàng

XỬ LÝ:
- Hệ thống nhận yêu cầu từ khách hàng
- Controller CartController.Index() được gọi
- Hệ thống xử lý:
  + Lấy danh sách sản phẩm từ Session (CartSessionKey)
  + Tính tổng tiền cho từng sản phẩm (Price × Quantity)
  + Tính tổng tiền toàn bộ giỏ hàng
- Dữ liệu được xử lý và gửi lên View

ĐẦU RA:
- Hiển thị danh sách sản phẩm trong giỏ hàng bao gồm:
  + Tên sản phẩm
  + Hình ảnh sản phẩm
  + Size và Color đã chọn
  + Giá bán
  + Số lượng
  + Thành tiền (Giá × Số lượng)
  + Tổng tiền toàn bộ giỏ hàng
- Nút "Cập nhật số lượng"
- Nút "Xóa sản phẩm"
- Nút "Thanh toán"


================================================================================
CHỨC NĂNG 5: THANH TOÁN ĐƠN HÀNG
================================================================================

ĐẦU VÀO:
- Khách hàng đã có sản phẩm trong giỏ hàng
- Khách hàng nhấn nút "Thanh toán"
- Khách hàng nhập thông tin giao hàng:
  + Họ và tên (bắt buộc)
  + Địa chỉ giao hàng (bắt buộc)
  + Số điện thoại (bắt buộc)
  + Ghi chú (tùy chọn)
- Khách hàng chọn phương thức thanh toán: VNPAY hoặc COD

XỬ LÝ:
- Hệ thống nhận yêu cầu từ khách hàng
- Controller CheckoutController.CreatePayment() được gọi
- Hệ thống xử lý:
  + Kiểm tra giỏ hàng có sản phẩm không
  + Validate thông tin form (FullName, Address, PhoneNumber)
  + Lấy danh sách sản phẩm từ Session
  + Tính tổng tiền đơn hàng
  + Tạo mã đơn hàng (OrderCode = DateTime.UtcNow.Ticks)
  + Lấy CustomerId từ Session (nếu khách hàng đã đăng nhập)
  
  Nếu chọn VNPAY:
  + Tạo VnPayRequest với OrderId, Amount, OrderDescription
  + Lưu thông tin checkout vào Session (CheckoutSessionKey)
  + Gọi VnPayService.CreatePaymentUrl() để tạo URL thanh toán
  + Redirect khách hàng đến trang thanh toán VNPAY
  
  Nếu chọn COD:
  + Tạo đơn hàng mới trong bảng TbOrders:
    - Code, CustomerId, ShippingAddress, TotalAmount
    - OrderStatusId = 1 (COD)
    - PaymentMethod = "cod"
    - CreatedDate, Note
  + Tạo chi tiết đơn hàng trong bảng TbOrderDetails cho từng sản phẩm
  + Lưu vào cơ sở dữ liệu
  + Xóa giỏ hàng khỏi Session
  + Redirect đến trang kết quả

  Xử lý Callback VNPAY:
  + Controller CheckoutController.PaymentCallback() được gọi
  + Validate chữ ký từ VNPAY
  + Kiểm tra ResponseCode = "00" (thành công)
  + Lấy thông tin từ Session
  + Tạo đơn hàng mới trong bảng TbOrders:
    - OrderStatusId = 2 (VNPAY)
    - PaymentMethod = "VNPAY"
  + Tạo chi tiết đơn hàng
  + Lưu vào cơ sở dữ liệu
  + Xóa giỏ hàng và session checkout

ĐẦU RA:
- Nếu chọn VNPAY:
  + Redirect đến trang thanh toán VNPAY
  + Sau khi thanh toán thành công, hiển thị trang kết quả với:
    - Thông báo "Thanh toán thành công"
    - Mã đơn hàng
    - Tổng tiền
    - Hướng dẫn tiếp theo

- Nếu chọn COD:
  + Hiển thị trang kết quả với:
    - Thông báo "Đặt hàng thành công. Bạn sẽ thanh toán khi nhận hàng!"
    - Mã đơn hàng
    - Tổng tiền
    - Thông tin đơn hàng đã được lưu vào hệ thống

- Giỏ hàng được xóa sau khi đặt hàng thành công


================================================================================
CHỨC NĂNG 6: ĐĂNG KÝ TÀI KHOẢN KHÁCH HÀNG
================================================================================

ĐẦU VÀO:
- Khách hàng truy cập vào địa chỉ website trên thanh URL
- Khách hàng chọn menu "Đăng ký" hoặc "Tài khoản"
- Khách hàng nhập thông tin:
  + Username (Tên đăng nhập)
  + Name (Họ và tên)
  + Email
  + Password (Mật khẩu)
  + ConfirmPassword (Xác nhận mật khẩu)

XỬ LÝ:
- Hệ thống nhận yêu cầu từ khách hàng
- Controller CustomerController.Register() được gọi
- Hệ thống xử lý:
  + Kiểm tra mật khẩu xác nhận có khớp không
  + Kiểm tra Email đã tồn tại trong bảng TbCustomers chưa
  + Kiểm tra Username đã tồn tại trong bảng TbCustomers chưa
  + Mã hóa mật khẩu bằng MD5
  + Tạo đối tượng TbCustomer mới:
    - Name, Username, Email, Password (đã mã hóa)
    - IsActive = true
    - LastLogin = DateTime.Now
  + Lưu vào cơ sở dữ liệu

ĐẦU RA:
- Nếu thành công:
  + Thông báo "Đăng ký thành công! Hãy đăng nhập."
  + Chuyển sang tab đăng nhập
- Nếu thất bại:
  + Hiển thị lỗi cụ thể:
    - "Mật khẩu xác nhận không khớp!"
    - "Email này đã được sử dụng!"
    - "Tên đăng nhập này đã có người dùng!"
  + Giữ lại thông tin đã nhập (trừ mật khẩu)


================================================================================
CHỨC NĂNG 7: ĐĂNG NHẬP TÀI KHOẢN KHÁCH HÀNG
================================================================================

ĐẦU VÀO:
- Khách hàng truy cập vào địa chỉ website trên thanh URL
- Khách hàng chọn menu "Đăng nhập" hoặc "Tài khoản"
- Khách hàng nhập thông tin:
  + Email hoặc Username
  + Password (Mật khẩu)

XỬ LÝ:
- Hệ thống nhận yêu cầu từ khách hàng
- Controller CustomerController.Login() được gọi
- Hệ thống xử lý:
  + Mã hóa mật khẩu nhập vào bằng MD5
  + Tìm kiếm khách hàng trong bảng TbCustomers:
    - Email == email HOẶC Username == email
    - Password == passHash (mật khẩu đã mã hóa)
  + Kiểm tra tài khoản có IsActive = true không
  + Cập nhật LastLogin = DateTime.Now
  + Lưu Session:
    - CustomerId
    - UserName

ĐẦU RA:
- Nếu thành công:
  + Lưu thông tin đăng nhập vào Session
  + Redirect về trang chủ
  + Hiển thị tên người dùng trên header
- Nếu thất bại:
  + Hiển thị thông báo lỗi:
    - "Email hoặc Mật khẩu không đúng!"
    - "Tài khoản đang bị khóa!" (nếu IsActive = false)


================================================================================
CHỨC NĂNG 8: XEM LỊCH SỬ ĐƠN HÀNG (Dashboard Khách hàng)
================================================================================

ĐẦU VÀO:
- Khách hàng đã đăng nhập
- Khách hàng truy cập vào địa chỉ website trên thanh URL
- Khách hàng chọn menu "Tài khoản" hoặc "Dashboard"
- Yêu cầu: Xem thông tin tài khoản và lịch sử đơn hàng

XỬ LÝ:
- Hệ thống nhận yêu cầu từ khách hàng
- Controller CustomerController.Dashboard() được gọi
- Hệ thống kiểm tra Session CustomerId
- Hệ thống truy vấn cơ sở dữ liệu:
  + Lấy thông tin khách hàng từ bảng TbCustomers theo CustomerId
  + Lấy danh sách đơn hàng từ bảng TbOrders:
    - Lọc theo CustomerId
    - Include thông tin OrderStatus
    - Include thông tin OrderDetails và Product
    - Sắp xếp theo CreatedDate DESC
- Dữ liệu được xử lý và gửi lên View

ĐẦU RA:
- Hiển thị thông tin tài khoản:
  + Họ và tên
  + Email
  + Username
  + Số điện thoại
  + Địa chỉ
- Hiển thị danh sách đơn hàng bao gồm:
  + Mã đơn hàng
  + Ngày đặt hàng
  + Trạng thái đơn hàng (Mới, Đang xử lý, Đang giao hàng, Hoàn thành, Đã hủy)
  + Tổng tiền
  + Phương thức thanh toán
  + Chi tiết sản phẩm trong đơn
- Link xem chi tiết từng đơn hàng


================================================================================
CHỨC NĂNG 9: XEM BLOG
================================================================================

ĐẦU VÀO:
- Khách hàng truy cập vào địa chỉ website trên thanh URL
- Khách hàng chọn menu "Blog" hoặc truy cập trực tiếp vào trang blog
- Yêu cầu: Xem danh sách bài viết blog

XỬ LÝ:
- Hệ thống nhận yêu cầu từ khách hàng
- Controller BlogController.Index() được gọi
- Hệ thống truy vấn cơ sở dữ liệu:
  + Lấy danh sách blog từ bảng TbBlogs
  + Lọc các blog có IsActive = true
  + Include thông tin BlogCategory và Account (tác giả)
  + Sắp xếp theo ngày tạo mới nhất
- Dữ liệu được xử lý và gửi lên View

ĐẦU RA:
- Hiển thị danh sách bài viết blog bao gồm:
  + Tiêu đề bài viết
  + Hình ảnh đại diện
  + Mô tả ngắn
  + Danh mục blog
  + Tác giả
  + Ngày đăng
  + Link xem chi tiết


================================================================================
CHỨC NĂNG 10: XEM CHI TIẾT BLOG
================================================================================

ĐẦU VÀO:
- Khách hàng đang xem danh sách blog
- Khách hàng chọn một bài viết bất kỳ
- Thông tin yêu cầu: BlogId hoặc Alias của bài viết

XỬ LÝ:
- Hệ thống nhận yêu cầu từ khách hàng
- Controller BlogController.Details(id) được gọi
- Hệ thống truy vấn cơ sở dữ liệu:
  + Lấy thông tin blog từ bảng TbBlogs theo BlogId
  + Include thông tin BlogCategory và Account
  + Lấy danh sách bình luận từ bảng TbBlogComments:
    - Lọc theo BlogId
    - Include thông tin Customer
    - Sắp xếp theo ngày tạo
- Dữ liệu được xử lý và gửi lên View

ĐẦU RA:
- Hiển thị chi tiết bài viết bao gồm:
  + Tiêu đề
  + Hình ảnh
  + Nội dung chi tiết
  + Danh mục
  + Tác giả
  + Ngày đăng
  + Danh sách bình luận của độc giả
- Form để viết bình luận (nếu đã đăng nhập)


================================================================================
CHỨC NĂNG 11: GỬI YÊU CẦU LIÊN HỆ
================================================================================

ĐẦU VÀO:
- Khách hàng truy cập vào địa chỉ website trên thanh URL
- Khách hàng chọn menu "Liên hệ"
- Khách hàng nhập thông tin:
  + Tên
  + Email
  + Tiêu đề
  + Nội dung

XỬ LÝ:
- Hệ thống nhận yêu cầu từ khách hàng
- Controller ContactController được gọi
- Hệ thống xử lý:
  + Validate thông tin form
  + Tạo đối tượng TbContact mới:
    - Name, Email, Subject, Message
    - CreatedDate = DateTime.Now
    - IsRead = false
  + Lưu vào cơ sở dữ liệu

ĐẦU RA:
- Thông báo "Gửi yêu cầu thành công!"
- Form được reset
- Yêu cầu được lưu vào hệ thống để admin xử lý


================================================================================
CHỨC NĂNG 12: CHAT HỖ TRỢ VỚI AI
================================================================================

ĐẦU VÀO:
- Khách hàng truy cập vào địa chỉ website trên thanh URL
- Khách hàng mở cửa sổ chat hỗ trợ
- Khách hàng nhập câu hỏi hoặc yêu cầu hỗ trợ
- Thông tin: Message (tin nhắn của khách hàng)

XỬ LÝ:
- Hệ thống nhận yêu cầu từ khách hàng
- Controller ChatController.SendMessage() được gọi
- Hệ thống xử lý:
  + Lấy UserId từ Session (nếu đã đăng nhập) hoặc tạo GuestToken
  + Lưu tin nhắn của khách hàng vào bảng TbChatMessages
  + Kiểm tra các truy vấn đặc biệt:
    - Tìm kiếm sản phẩm: Gọi API tìm kiếm sản phẩm
    - Tra cứu đơn hàng: Lấy thông tin đơn hàng từ database
  + Gọi Gemini AI API để tạo phản hồi
  + Lưu phản hồi của AI vào database
  + Tự động xóa tin nhắn cũ (sau 24 giờ)

ĐẦU RA:
- Hiển thị tin nhắn của khách hàng trong cửa sổ chat
- Hiển thị phản hồi từ AI hỗ trợ
- Nếu có tìm kiếm sản phẩm: Hiển thị danh sách sản phẩm liên quan
- Nếu có tra cứu đơn hàng: Hiển thị thông tin đơn hàng
- Lịch sử chat được lưu và hiển thị khi khách hàng quay lại


================================================================================
CHỨC NĂNG 13: ĐÁNH GIÁ SẢN PHẨM
================================================================================

ĐẦU VÀO:
- Khách hàng đã đăng nhập
- Khách hàng đã mua sản phẩm
- Khách hàng đang xem chi tiết sản phẩm
- Khách hàng nhập thông tin:
  + Số sao đánh giá (1-5 sao)
  + Nội dung đánh giá

XỬ LÝ:
- Hệ thống nhận yêu cầu từ khách hàng
- Controller ProductReview được gọi
- Hệ thống xử lý:
  + Kiểm tra khách hàng đã mua sản phẩm chưa (kiểm tra trong TbOrders)
  + Tạo đối tượng TbProductReview mới:
    - ProductId, CustomerId
    - Star (số sao)
    - Comment (nội dung đánh giá)
    - CreatedDate = DateTime.Now
    - IsActive = true
  + Lưu vào cơ sở dữ liệu
  + Cập nhật điểm đánh giá trung bình của sản phẩm

ĐẦU RA:
- Thông báo "Cảm ơn bạn đã đánh giá sản phẩm!"
- Đánh giá được hiển thị ngay trên trang chi tiết sản phẩm
- Cập nhật điểm đánh giá trung bình của sản phẩm


================================================================================
CHỨC NĂNG 14: QUẢN TRỊ - XEM DANH SÁCH SẢN PHẨM (ADMIN)
================================================================================

ĐẦU VÀO:
- Admin đã đăng nhập vào hệ thống
- Admin truy cập vào địa chỉ /Admin/Products
- Yêu cầu: Xem danh sách tất cả sản phẩm trong hệ thống

XỬ LÝ:
- Hệ thống kiểm tra Session AdminId
- Controller ProductsController.Index() được gọi
- Hệ thống truy vấn cơ sở dữ liệu:
  + Lấy danh sách sản phẩm từ bảng TbProducts
  + Include thông tin CategoryProduct
  + Include thông tin TbProductVariants (kèm Size và Color)
  + Không lọc theo IsActive (hiển thị tất cả)
- Dữ liệu được xử lý và gửi lên View

ĐẦU RA:
- Hiển thị danh sách sản phẩm bao gồm:
  + ID sản phẩm
  + Tên sản phẩm
  + Hình ảnh
  + Danh mục
  + Giá bán
  + Số lượng tồn kho
  + Trạng thái (Hoạt động/Không hoạt động)
  + Các biến thể (Size, Color)
- Nút "Thêm mới", "Chỉnh sửa", "Xóa", "Xem chi tiết"


================================================================================
CHỨC NĂNG 15: QUẢN TRỊ - TẠO SẢN PHẨM MỚI (ADMIN)
================================================================================

ĐẦU VÀO:
- Admin đã đăng nhập
- Admin chọn "Thêm sản phẩm mới"
- Admin nhập thông tin:
  + Tên sản phẩm, Mô tả, Nội dung chi tiết
  + Danh mục sản phẩm
  + Hình ảnh
  + Giá bán, Giá khuyến mãi
  + Số lượng tồn kho
  + Đánh dấu: Sản phẩm mới, Bán chạy, Hoạt động
  + Các biến thể: Size, Color, SKU, Giá, Số lượng cho từng biến thể

XỬ LÝ:
- Hệ thống nhận yêu cầu từ admin
- Controller ProductsController.Create() được gọi
- Hệ thống xử lý:
  + Validate thông tin form
  + Tạo đối tượng TbProduct mới:
    - Title, Alias, Description, Detail, Image
    - CategoryProductId, Price, PriceSale, Quantity
    - IsNew, IsBestSeller, IsActive
    - CreatedDate = DateTime.Now
  + Lưu sản phẩm vào bảng TbProducts
  + Với mỗi biến thể (Variant):
    - Tạo đối tượng TbProductVariant
    - ProductId, ColorId, SizeId, SKU
    - Price, PriceSale, Quantity, IsActive
    - Lưu vào bảng TbProductVariants
  + Lưu vào cơ sở dữ liệu

ĐẦU RA:
- Thông báo "Thêm sản phẩm thành công!"
- Redirect về trang danh sách sản phẩm
- Sản phẩm mới được hiển thị trong danh sách


================================================================================
CHỨC NĂNG 16: QUẢN TRỊ - QUẢN LÝ ĐƠN HÀNG (ADMIN)
================================================================================

ĐẦU VÀO:
- Admin đã đăng nhập
- Admin truy cập vào /Admin/Orders
- Admin có thể lọc theo trạng thái: Tất cả, Mới, Đang xử lý, Đang giao hàng, Hoàn thành, Đã hủy
- Yêu cầu: Xem và quản lý đơn hàng

XỬ LÝ:
- Hệ thống kiểm tra Session AdminId
- Controller OrdersController.Index(status) được gọi
- Hệ thống truy vấn cơ sở dữ liệu:
  + Lấy danh sách đơn hàng từ bảng TbOrders
  + Include thông tin Customer, OrderStatus, OrderDetails, Product
  + Lọc theo OrderStatusId nếu status != "all"
  + Sắp xếp theo CreatedDate DESC
- Dữ liệu được xử lý và gửi lên View

ĐẦU RA:
- Hiển thị danh sách đơn hàng bao gồm:
  + Mã đơn hàng
  + Khách hàng
  + Ngày đặt hàng
  + Trạng thái đơn hàng
  + Tổng tiền
  + Phương thức thanh toán
  + Chi tiết sản phẩm trong đơn
- Dropdown lọc theo trạng thái
- Nút "Xem chi tiết", "Cập nhật trạng thái", "Xóa"


================================================================================
CHỨC NĂNG 17: QUẢN TRỊ - CẬP NHẬT TRẠNG THÁI ĐƠN HÀNG (ADMIN)
================================================================================

ĐẦU VÀO:
- Admin đang xem chi tiết đơn hàng
- Admin chọn trạng thái mới từ dropdown
- Thông tin: OrderId, OrderStatusId mới

XỬ LÝ:
- Hệ thống nhận yêu cầu từ admin
- Controller OrdersController.UpdateStatus(id, orderStatusId) được gọi
- Hệ thống xử lý:
  + Tìm đơn hàng trong bảng TbOrders theo OrderId
  + Cập nhật OrderStatusId = orderStatusId mới
  + Cập nhật ModifiedDate = DateTime.Now
  + Lưu vào cơ sở dữ liệu

ĐẦU RA:
- Thông báo "Cập nhật trạng thái đơn hàng thành công!"
- Trạng thái đơn hàng được cập nhật
- Redirect về trang chi tiết đơn hàng


================================================================================
CHỨC NĂNG 18: QUẢN TRỊ - XEM BÁO CÁO DOANH THU (ADMIN)
================================================================================

ĐẦU VÀO:
- Admin đã đăng nhập
- Admin truy cập vào /Admin/Reports/Revenue
- Admin có thể chọn khoảng thời gian: StartDate, EndDate
- Yêu cầu: Xem báo cáo doanh thu

XỬ LÝ:
- Hệ thống kiểm tra Session AdminId
- Controller ReportsController.Revenue(startDate, endDate) được gọi
- Hệ thống truy vấn cơ sở dữ liệu:
  + Lấy danh sách đơn hàng từ bảng TbOrders:
    - Lọc theo CreatedDate trong khoảng thời gian
    - Include thông tin OrderStatus
  + Tính toán:
    - Tổng doanh thu: Sum(TotalAmount) của các đơn "Hoàn thành"
    - Tổng số đơn hàng: Count()
    - Số đơn hoàn thành: Count() với OrderStatus.Name chứa "Hoàn thành"
- Dữ liệu được xử lý và gửi lên View

ĐẦU RA:
- Hiển thị báo cáo doanh thu bao gồm:
  + Khoảng thời gian được chọn
  + Tổng doanh thu
  + Tổng số đơn hàng
  + Số đơn hàng hoàn thành
  + Danh sách đơn hàng trong khoảng thời gian
- Biểu đồ doanh thu (nếu có)
- Khả năng xuất báo cáo


================================================================================
KẾT LUẬN
================================================================================

Tất cả các chức năng trên đều tuân theo quy trình:
1. ĐẦU VÀO: Khách hàng/Admin thực hiện hành động trên giao diện
2. XỬ LÝ: Hệ thống nhận yêu cầu, truy vấn/xử lý dữ liệu từ cơ sở dữ liệu
3. ĐẦU RA: Hiển thị kết quả cho người dùng

Hệ thống đảm bảo:
- Bảo mật: Kiểm tra session cho các trang admin
- Validation: Kiểm tra dữ liệu đầu vào
- User Experience: Thông báo rõ ràng, giao diện thân thiện
- Data Integrity: Đảm bảo tính toàn vẹn dữ liệu

================================================================================
Ngày tạo: 2024
Phiên bản: 1.0
================================================================================

